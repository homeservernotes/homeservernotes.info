<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Dynamic DNS for DigitalOcean | Home Server Group</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Dynamic DNS for DigitalOcean" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Here is a bash script to keep a DigitalOcean DNS A record pointed back at your home internet. It depends on curl and jq, both of which should be available through most package managers if you don’t have them installed already." />
<meta property="og:description" content="Here is a bash script to keep a DigitalOcean DNS A record pointed back at your home internet. It depends on curl and jq, both of which should be available through most package managers if you don’t have them installed already." />
<meta property="og:site_name" content="Home Server Group" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-08-09T20:41:22-07:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Dynamic DNS for DigitalOcean" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-08-09T20:41:22-07:00","datePublished":"2024-08-09T20:41:22-07:00","description":"Here is a bash script to keep a DigitalOcean DNS A record pointed back at your home internet. It depends on curl and jq, both of which should be available through most package managers if you don’t have them installed already.","headline":"Dynamic DNS for DigitalOcean","mainEntityOfPage":{"@type":"WebPage","@id":"/2024/08/09/dynamic-dns-for-digitalocean.html"},"url":"/2024/08/09/dynamic-dns-for-digitalocean.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css">
  <link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Home Server Group" />
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Home Server Group</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Dynamic DNS for DigitalOcean</h1>
    <p class="post-meta"><time class="dt-published" datetime="2024-08-09T20:41:22-07:00" itemprop="datePublished">
        Aug 9, 2024
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><a href="https://github.com/dc25/digitalocean_dyndns.git">Here</a> is a bash script to keep a DigitalOcean DNS A record pointed back at your home internet.   It depends on curl and jq, both of which should be available through most package managers if you don’t have them installed already.</p>

<p>To use it, you will need a domain that uses Digitalocean name servers and a Digitalocean API token.   <a href="https://docs.digitalocean.com/products/networking/dns/details/pricing/">Per DigitalOcean</a>, this functionality is avaliable at no cost.   I did have to give them credit card information.</p>

<p>The script expects the domain whose “A” record will be updated to be in the file “DIGITALOCEAN_DOMAIN” and the API token to be in the file “DIGITALOCEAN_TOKEN”.</p>

<p>The script expects 1 or 0 arguments on the command line. If 1 argument is given, the the IP address given as command line argument will be saved in the “A” record.  Otherwise the script will use “curl” to retrieve the public IP address:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dave@driver:/tmp$ curl -4 icanhazip.com 2&gt; /dev/null
50.245.151.169
dave@driver:/tmp$
</code></pre></div></div>

<p>If the script completes successfully, it will save its IP value.   The next time the script runs, it will check the current IP value against the previous IP value and exit if they are the same.  This prevents repeat calls to the DigitalOcean API with the same values.</p>

<p>To use the script, clone the repository, create the files DIGITALOCEAN_DOMAIN and DIGITALOCEAN_TOKEN and run the script:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dave@driver:~$
dave@driver:~$ git clone https://github.com/dc25/digitalocean_dyndns.git
Cloning into 'digitalocean_dyndns'...
remote: Enumerating objects: 9, done.
remote: Counting objects: 100% (9/9), done.
remote: Compressing objects: 100% (8/8), done.
remote: Total 9 (delta 3), reused 5 (delta 0), pack-reused 0
Receiving objects: 100% (9/9), done.
Resolving deltas: 100% (3/3), done.
dave@driver:~$ cd digitalocean_dyndns/
dave@driver:~/digitalocean_dyndns$
dave@driver:~/digitalocean_dyndns$ ls
dyndns.bash
dave@driver:~/digitalocean_dyndns$  cat &gt; DIGITALOCEAN_DOMAIN
cgull.tech
dave@driver:~/digitalocean_dyndns$ cat &gt; DIGITALOCEAN_TOKEN
dop_v1_f5b0685c95f896e55e64df50d2f108704c391c34cda8310ad229eede609ba928
dave@driver:~/digitalocean_dyndns$
dave@driver:~/digitalocean_dyndns$ ./dyndns.bash
deleting existing A record for cgull.tech
adding new A record for cgull.tech with value : 50.245.151.169
update worked so saving arguments "50.245.151.169" in /home/dave/repeat_check/dyndns.bash
dave@driver:~/digitalocean_dyndns$
dave@driver:~/digitalocean_dyndns$ ./dyndns.bash
previous update was also with argument: "50.245.151.169" so exiting now to avoid duplicate work.
dave@driver:~/digitalocean_dyndns$
</code></pre></div></div>

<p>Use cron to automate running on regular basis (once per minute shown in transcript below):</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dave@driver:/tmp$ crontab -l
* *  * * *   /home/dave/digitalocean_dyndns/dyndns.bash &gt; /tmp/dyndns.bash.out
dave@driver:/tmp$ date
Mon Aug 12 09:50:24 AM PDT 2024
dave@driver:/tmp$ ls dyndns.bash.out
ls: cannot access 'dyndns.bash.out': No such file or directory
dave@driver:/tmp$ date
Mon Aug 12 09:51:09 AM PDT 2024
dave@driver:/tmp$ ll dyndns.bash.out
-rw-rw-r-- 1 dave dave 195 Aug 12 09:51 dyndns.bash.out
dave@driver:/tmp$ cat !$
cat dyndns.bash.out
deleting existing A record for cgull.tech
adding new A record for cgull.tech with value : 50.245.151.169
update worked so saving arguments "50.245.151.169" in /home/dave/repeat_check/dyndns.bash
dave@driver:/tmp$
dave@driver:/tmp$ date
Mon Aug 12 09:52:07 AM PDT 2024
dave@driver:/tmp$ cat dyndns.bash.out
previous update was also with argument: "50.245.151.169" so exiting now to avoid duplicate work.
dave@driver:/tmp$
</code></pre></div></div>

  </div><a class="u-url" href="/2024/08/09/dynamic-dns-for-digitalocean.html" hidden></a>
</article>

      </div>
    </main>

    <div class="page-content">
      <div class="wrapper">
        
    
<div id="gh-comments">
    <br/><br/>
    <h6>COMMENTS</h6>
    <div id="gh-comments-list"></div>
</div>

<script src="/js/github-comments.js"> </script>

<script type="text/javascript"> 
    DoGithubComments ( 
        "homeservernotes/homeservernotes.info" , 
        "31" 
    ); 
</script>

<noscript>Please enable JavaScript to view comments.</noscript>



      </div>
    </div><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <path d="M12.8 16C12.8 8.978 7.022 3.2 0 3.2V0c8.777 0 16 7.223 16 16h-3.2zM2.194
                11.61c1.21 0 2.195.985 2.195 2.196 0 1.21-.99 2.194-2.2 2.194C.98 16 0 15.017 0
                13.806c0-1.21.983-2.195 2.194-2.195zM10.606
                16h-3.11c0-4.113-3.383-7.497-7.496-7.497v-3.11c5.818 0 10.606 4.79 10.606 10.607z"
              />
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p></p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>
